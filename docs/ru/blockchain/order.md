# Биржевая заявка

**Биржевая заявка** или **ордер** — инструкция [владельца аккаунта](/ru/blockchain/account) [матчеру](https://docs.waves.exchange/en/waves-matcher/) на покупку или продажу [токена](/ru/blockchain/token).

## Отмена заявки <a id="cancel"></a>

Отправитель заявки может отменить заявку до того как она будет исполнена.

Неисполненные заявки автоматически отменяются по истечению 30 дней с момента открытия.

## Дата истечения заявки

**Дата истечения заявки** — дата, когда заявка автоматически аннулируется, если она не будет исполнена к этой дате.

Дата указывается в _миллисекундах_, которые прошли с начала [эпохи Unix](https://ru.wikipedia.org/wiki/Unix-время) до даты истечения заявки.

Время истечения заявки составляет от 1 минуты до 30 дней.

## Временная метка заявки

**Временна́я метка заявки** — время, когда [матчер](https://docs.waves.exchange/en/waves-matcher/) добавил [заявку](/ru/blockchain/order) в [биржевой стакан](https://ru.wikipedia.org/wiki/Биржевой_стакан).

Время указывается в _миллисекундах_, которые прошли с начала [эпохи Unix](https://ru.wikipedia.org/wiki/Unix-время).

## Бинарный формат ордера

Смотрите страницу [Бинарный формат ордера](/ru/blockchain/binary-format/order-binary-format).

## Amount и price в ордере

В пользовательском интерфейсе amount и price отображаются в виде значений с дробной частью, однако в самом ордере они должны быть представлены в нормализованном (т.е. целочисленном) виде.

Чтобы привести amount к нормализованному виду, он умножается на 10<sup>amountAssetDecimals</sup>.

Чтобы привести price к нормализованному виду, он умножается

* в ордерах версий 1, 2, 3: на 10<sup>(8 + priceAssetDecimals - amountAssetDecimals)</sup>,
* в ордерах версии 4: на 10<sup>8</sup>.

Количество price-ассета в нормализованном виде вычисляется по следующей формуле

* в ордерах версий 1, 2, 3: amount × price × 10<sup>-8</sup>,
* ордерах версии 4: amount × price × 10<sup>(priceAssetDecimals - amountAssetDecimals - 8)</sup>.

В обоих случаях дробная часть отбрасывается.

Обозначения в приведенной формуле:

* amount — amount в нормализованном виде,
* price — price в нормализованном виде,
* priceAssetDecimals — количество знаков после запятой у price-ассета,
* amountAssetDecimals — количество знаков после запятой у amount-ассета.

## Пример расчета для ордера v1/v2/v3

Рассмотрим покупку 2,13 Tidex по цене 0,35016774 WAVES за один Tidex.

Amount-ассетом является Tidex, значение amountAssetDecimals равно 2.

Price-ассетом является Waves, значение priceAssetDecimals равно 8.

Значение amount в нормализованном виде равно 2,13 × 10<sup>amountAssetDecimals</sup> = 213.

Значение price в нормализованном виде равно 0,35016774 × 10<sup>(8 + 8 - 2)</sup> = 35016774 × 10<sup>6</sup>.

Количество price-ассета в нормализованном виде будет рассчитано следующим образом:  213 × 35016774 × 10<sup>6</sup> × 10<sup>-8</sup> = 74585728,62. Дробная часть будет отброшена.

В результате за 2,13 Tidex будет выручено 0,74585728 Waves.

## Пример расчета для ордера v4

Рассмотрим покупку 2,13 Tidex по цене 0,35016774 WAVES за один Tidex.

Amount-ассетом является Tidex, значение amountAssetDecimals равно 2.

Price-ассетом является Waves, значение priceAssetDecimals равно 8.

Значение amount в нормализованном виде равно 2,13 × 10amountAssetDecimals = 213.

Значение price в нормализованном виде равно 0,35016774 × 10<sup>8</sup> = 35016774.

Количество price-ассета в нормализованном виде будет рассчитано следующим образом:  213 × 35016774 × 10<sup>(8 - 2 - 8)</sup> = 74585728,62. Дробная часть будет отброшена.

В результате за 2,13 Tidex будет выручено 0,74585728 Waves.
