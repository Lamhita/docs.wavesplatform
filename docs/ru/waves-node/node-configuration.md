---
sidebarDepth: 2
---

# Конфигурация ноды

**Файл конфигурации** это файл в котором хранятся настройки [ноды](/ru/blockchain/node).

В системе конфигурации ноды Waves применяется формат HOCON (Human-Optimized Config Object Notation). Подробное описание HOCON доступно по ссылке [Official HOCON documentation](https://github.com/lightbend/config/blob/master/HOCON.md). Преимущества HOCON — это простой синтаксис и возможность использовать комментарии.

## Стандартные файлы конфигурации и ручные настройки

### Стандартный файл конфигурации, вложенный в JAR

[Пример](https://github.com/wavesplatform/Waves/blob/master/node/src/main/resources/application.conf) стандартного файла конфигурации ноды, встроенного в jar-файл на Github.

> После обновления до версии 1.0.2 обратите внимание, что если ваш файл `/etc/waves/waves.conf` был изначально скопирован из шаблона, то следует убедиться, что параметр `waves.directory` задан верно. Если параметр не задан, то будет использоваться стандартный путь. Подробнее  в секции [Waves Configuration](#waves-configuration-section).

### Изменение параметров JAR-ноды

Рекомендуется изменять параметры JAR-ноды, передавая их в файл конфигурации с помощью командной строки. Для запуска ноды использует следующую команду.
Замените {*} на реальное имя файла:

```bash
java -jar {*}.jar {*}.conf
```

Файл конфигурации содержит уникальные характеристики вашей ноды (IP-адрес, имя, ключи и т. д.) и специфичные параметры сети, аналогичные настройкам из файлов, описанным далее (файлы, поставляемые с пакетами DEB).

### Файлы конфигурации Mainnet и Testnet в пакетах DEB

Установочные пакеты DEB содержат файлы конфигурации, которые переопределяют некоторые параметры, специфичные для сети:

* <https://github.com/wavesplatform/Waves/blob/master/node/waves-mainnet.conf>
* <https://github.com/wavesplatform/Waves/blob/master/node/waves-testnet.conf>
* <https://github.com/wavesplatform/Waves/blob/master/node/waves-stagenet.conf>

## Секции файла конфигурации

| Секция         | Описание                                                   |
|-----------------|---------------------------------------------------------------|
| [waves](#waves-configuration)| Основные параметры ноды и другие подсекции конфигурации |
| &nbsp; &nbsp; &nbsp; db              | Параметры базы данных блокчейна |
| &nbsp; &nbsp; &nbsp; [network](#настройки-сети)| Параметры сети Peer to peer |
| &nbsp; &nbsp; &nbsp; [wallet](#настройки-кошелька)| Параметры встроенного кошелька ноды |
| &nbsp; &nbsp; &nbsp; [blockchain](#настройки-болкчейн)| Параметры блокчейна |
| &nbsp; &nbsp; &nbsp; [miner](#настройки-майнера)| Параметры генератора блока |
| &nbsp; &nbsp; &nbsp; [rest-api](#настройки-rest-api)        | Параметры API ноды |
| &nbsp; &nbsp; &nbsp; [synchronization](#настройки-синхронизации) | Параметры синхронизации ноды |
| &nbsp; &nbsp; &nbsp; [utx](#настройки-utx-пула)| Параметры пула неподтвержденных транзакций |
| &nbsp; &nbsp; &nbsp; [features](#настройки-фич)        | Параметры фич |
| &nbsp; &nbsp; &nbsp; [rewards](#настройки-вознаграждений)| Параметры вознаграждений |
| &nbsp; &nbsp; &nbsp; extensions| Параметры расширений |
| kamon           | Параметры метрик производительности |
| metrics         | Блоки, транзакции и другие параметры метрик |

### Настройки Waves

Корневая секция `waves` содержит ключевые параметры и прочие конфигурационные подсекции.

С помощью параметра `directory` можно назначить путь к основной папке приложения. В настройках параметров конфигурации можно использовать переменные среды (environment variables). Пожалуйста, не заключайте переменные среды в кавычки: в этом случае они будут обработаны как строки и не будут применены.

Убедитесь, что для выбранной папки корректно указан owner: `waves` для Mainnet и `waves-testnet` для Testnet.

#### Каталог приложения по умолчанию

Для ноды, установленной из пакета DEB:

| | *nix (DEB пакет) |
| :--- | :--- |
| Mainnet | `/var/lib/waves` |
| Testnet | `/var/lib/waves-testnet` |
| Stagenet| `/var/lib/waves-stagenet` |

Следующие пути по умолчанию, в зависимости от операционной системы и типа блокчейна, используются для нод JAR, если параметр `directory` не задан в файле конфигурации `.conf`:

| | *nix | macOS | Windows |
| :--- | :--- | :--- | :--- |
| Mainnet | `$XDG_DATA_HOME/waves-mainnet` or `$HOME/.local/share/waves-mainnet` | `$HOME/Library/Application Support/waves-mainnet` | `%LOCALAPPDATA%/waves-mainnet` |
| Testnet | `$XDG_DATA_HOME/waves-testnet` or `$HOME/.local/share/waves-testnet` | `$HOME/Library/Application Support/waves-testnet` | `%LOCALAPPDATA%/waves-testnet` |
| Stagenet | `$XDG_DATA_HOME/waves-stagenet` or `$HOME/.local/share/waves-stagenet` | `$HOME/Library/Application Support/waves-stagenet` | `%LOCALAPPDATA%/waves-stagenet` |
| Custom | `$XDG_DATA_HOME/waves-custom-<character>*` or `$HOME/.local/share/waves-custom-<character>*` | `$HOME/Library/Application Support/waves-custom-<character>*` | `%LOCALAPPDATA%/waves-custom-<character>*` |

\* См. описание параметра `address-scheme-character` в секции [Настройка Custom блокчейна](#section-20ddd805c332b711c4699ea1c9539300).

Используйте параметр `leveldb-cache-size` чтобы задать размер внутреннего кэша базы LevelDB.

**Примечание:** Необходимо указать количество байт для установки параметра размера кэша. Но вы можете использовать единицы измерения: <ul><li>K - для килобайта</li><li>M - для мегабайта</li><li>G - для гигабайта</li></ul>

### Настройки сети

В секции `network` можно настроить параметры P2P сети.

| Имя | Описание | Значение по умолчанию |
|-----------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `file` | Задает путь базы данных, где нода хранит списки известных и занесенных в черный список пиров | По умолчанию путь формируется относительно базовой директории из секции `waves` |
| `declared-address` | Задает внешний IP-адрес и номер порта ноды. Необходимо работать за NAT на большинстве облачных хостингов, где машина не взаимодействует напрямую с внешним адресом. Формат этого параметра: "\[ip-address\] :\[port\]" | Если вы не укажете его, то ваша нода подключится к сети P2P, но не будет прослушивать входящие подключения, поэтому другие ноды не смогут подключиться. Другие ноды подключаются к вашей ноде с использованием этих данных |
| `bind-address` | Задает IP-адрес локального сетевого интерфейса, на котором нода будет принимать входящие соединения | По умолчанию нода привязана к `0.0.0.0` это значит, что она будет принимать соединения на всех доступных сетевых адаптерах |
| `port` | Задает номер сетевого порта, к которому будут подключаться другие ноды Waves. Убедитесь, что порт доступен извне, иначе ваша нода будет подключаться к сети P2P только через исходящие соединения. Если этот порт занят другим приложением, ваша нода не запустится | |
| `node-name` | Задает имя вашей ноды, видимого для других участников P2P-сети. Имя, переданное во время первоначального рукопожатия (handshake) | По умолчанию этот параметр закомментирован, а имя ноды генерируется случайным образом |
| `nonce` | Это значение отправляется во время рукопожатия. Используется для различения нод, подключенных к одному IP-адресу | По умолчанию параметр не задан и значение генерируется случайным образом |
| `known-peers` | Этот параметр хранит список нод начальной загрузки, к которым ваша нода будет устанавливать исходящие соединения при инициализации | |
| `peers-data-residence-time` | Задает период времени, в течение которого нода хранит информацию о внешней ноде с момента последнего сеанса связи с ней. | |
| `black-list-residence-time` | Задает период времени, в течении которого нода хранит информацию о внешней ноде, помещённой в черный список | |
| `max-inbound-connections` | Задает максимальное количество одновременных входящих соединений, обрабатываемых нодой | |
| `max-outbound-connections` | Задает максимальное количество исходящих сетевых подключений | |
| `max-single-host-connections` | Задает разрешенное количество сетевых подключений с одного IP-адреса | |
| `connection-timeout` | Задает таймаут сетевого соединения | |
| `outbound-buffer-size` | Задает размер сетевого буфера. Лучше оставить значение по умолчанию, неправильный размер буфера может привести к неисправности ноды | |
| `max-unverified-peers` | Задает максимальный размера буфера для хранения информации об одноранговых нодах во время процесса установления связи | |
| `enable-peers-exchange` | Позволяет включить или отключить запрос и отправку информации о пирах | |
| `enable-blacklisting` | Позволяет включить или отключить черный список пиров | |
| `peers-broadcast-interval` | Задает промежуток времени между трансляциями списка известных пиров на другие ноды | |
| `handshake-timeout` | Задает период ожидания ответа при рукопожатии. В случае отсутствия ответа, партнер будет занесен в черный список | |
| `upnp` | Этот раздел позволяет настроить параметры UPnP. Эти настройки полезны только в том случае, если вы запускаете свою ноду в домашней сети, где она может попросить маршрутизатор установить туннель. | По умолчанию эта функция отключена. Используйте параметр `enable` `upnp`, чтобы включить эту функцию |
| `traffic-logger` | Этот раздел позволяет включить или отключить ведение журнала некоторых входящих или исходящих сетевых сообщений. Сетевые сообщения регистрируются на уровне TRACE | |

**Примечание:** Все промежутки времени указываются в миллисекундах либо с использованием единиц измерения:
<ul><li>s — секунды</li><li>m — минуты</li><li>h — часы</li><li>d — дни</li></ul>
С примерами применения можно ознакомиться в стандартном конфигурационном файле выше.

### Настройки кошелька

В секции `wallet` можно настроить [встроенный в ноду кошелек Waves](/ru/waves-node/how-to-work-with-node-wallet).

| Имя | Описание | Значение по умолчанию |
|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------|
| `file` | Задает путь к файлу кошелька ноды | По умолчанию путь формируется относительно базовой директории приложения |
| `password` | Задает пароль для защиты файла кошелька ноды | |
| `seed` | Этот параметр используется для воссоздания существующего кошелька на новой ноде. Предоставьте строку `BASE58` вашей сид фразы здесь. Если у вас нет кошелька, закомментируйте этот параметр и запустите ноду. Во время первого запуска приложение создаст для вас новый кошелек со случайной сид фразой. В этом случае сид будет отображаться в журнале приложения. Если вы пропустили его или не хотите проверять файлы журналов, он также будет доступен в REST API с использованием метода `wallet/seed` | |

**Warning:** Кошелек является важнейшей частью вашей ноды. Лучше создать его файл в безопасном и защищенном месте. Не забудьте сделать резервную копию файла кошелька. Рекомендуется удалить сид из файла конфигурации сразу после запуска ноды. Если злоумышленник получит доступ к сид строке, он получит доступ к вашим средствам по всем вашим адресам!

### Настройки блокчейн

В секции `blockchain` можно задать тип блокчейна или настроить свой собственный (custom) блокчейн.

| Имя | Описание | Значение по умолчанию |
|---------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| `max-transactions-per-block-diff` | Задает количество транзакций, которые будут храниться в памяти перед сохранением на диск. Уменьшение этого значения может увеличить количество операций записи на диск | |
| `min-blocks-in-memory` | Позволяет изменить минимальное количество блоков, которые будут храниться в памяти | |
| `type` | Задает тип блокчейна. Доступные опции: TESTNET, MAINNET, STAGENET и CUSTOM. Для типов MAINNET, TESTNET и STAGENET параметры блокчейна встроены в приложение, поэтому дополнительная настройка не требуется. При выборе блокчейна типа CUSTOM необходимо задать параметры секции `custom` | |

#### Настройка custom блокчейна

Секция `custom` позвлдяет задать параметры [custom блокчейна](/ru/waves-node/private-waves-network).

| Имя | Описание | Значение по умолчанию |
|--------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| `address-scheme-character` | Данный параметр в секции `custom` позволяет задать address feature character. Для использования при создании адреса, а также передачи по сети во время рукопожатия, что позволяет нодам не подключаться к нодам из других блокчейнов | |
| `functionality` | Данная секция позволяет задать временные отметки активации различных валидаций блокчейна. Лучше установить все настройки функциональности на 0 для активации всех валидаций | |
| `genesis` | Секция описывает первый (genesis) блок вашего custom блокчейна | |
| `block-timestamp` | Задает дату создания genesis блока | |
| `timestamp` | Задает время создания genesis транзакций |               |
| `signature` | Задает подпись genesis блока |               |
| `initial-balance` | Данный параметр позволяет задать общее пеорвоначальное количество токенов. Это значение следует задавать в минимальных неделимых единицах криптовалюты | |
| `average-block-delay` | Задает скорость генерации блока в блокчейне. Это целевой период времени между блоками. На самом деле задержки между блоками могут варьироваться | |
| `transactions` | Позволяет предоставить список первых транзакций. Каждая транзакция описывается адресом получателя (как строка BASE58) и суммой. Вы должны распределить весь начальный баланс по одному или нескольким адресам в genesis блоке. Если вы этого не сделали, genesis блок будет считаться неправильным и приложение не запустится | |

### Настройки майнера

В секции `miner` можно задать параметры генератора блоков.

| Имя | Описание | Значение по умолчанию |
|------------------------------------------------------|-----------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `enable` | Позволяет включить/выключить генерацию блоков нодой. По умолчанию генерация включена, но если ее выключить, то нода не будет генерировать новые блоки |
| `quorum` | Задает минимальное количество подключенных нод, необходимых для майнинга новых блоков | По умолчанию задано значение 1. Это означает, что ваша нода начнет майнинг сразу, как только подключится к первой ноде P2P-сети. Если задать значение 0, то активируется офлайн-генерация |
| `interval-after-last-block-then-generation-is-allowed` | Позволяет настроить загрузку и генерацию блоков | По умолчанию задано значение 1 день. Это означает, что ваша нода не начнет генерацию, если последний блок локального блокчейна старше 1 дня. Используя данный параметр, вы даете команду ноде актуализировать блокчейн перед началом генерации новых блоков. Это применимо только после длительных отключений ноды |
| `no-quorum-mining-delay` | Задает задержку попыток майнинга, если кворум недоступен |
| `micro-block-interval` | Задает интервал между микроблоками |
| `max-transactions-in-micro-block` | Устанавливает максимальное количество транзакций в микроблоке |
| `min-micro-block-age` |  |
| `minimal-block-generation-offset` | Задает минимальный оффсет генерации блока |
| `max-pack-time` | Задает максимальное время packUnconfirmed |

### Настройки REST API

Секция **REST API** файла конфигурации ноды содержит настройки [Node API](/ru/waves-node/node-api).

| # | Имя | Описание | Значение по умолчанию |
| :--- | :--- | :--- | :--- |
| 1 | enable | Активирует REST API. <br>Для деактивации REST API укажите значение `no`. | yes |
| 2 | `bind-address` | Назначает сетевой адрес, по которому REST API будет принимать входящие подключения. <br>**Примечание**. Не рекомендуется менять значение по умолчанию. Используйте [Nginx’s proxy pass module](http://nginx.org/ru/docs/http/ngx_http_proxy_module.html) или [SSH port forwarding](http://blog.trackets.com/2014/05/17/ssh-tunnel-local-and-remote-port-forwarding-explained-with-examples.html) для внешнего доступа. | `"127.0.0.1"` |
| 3 | `port` | Задает номер порта, через который REST API будет ожидать подключения. | 6869 |
| 4 | `api-key-hash` | Задает хэш [API key](https://en.wikipedia.org/wiki/Application_programming_interface_key), который предоставляется владельцем ноды.<br> API key владельца ноды — очень важный параметр, так же как и [SEED-фраза](/en/blockchain/waves-protocol/cryptographic-practical-details#creating-a-private-key-from-a-seed) и пароль кошелька.<br>Для генерации хэша API key:<br> 1. Перейдите в [Swagger web interface](/ru/waves-node/node-api).<br>2. Нажмите на секцию [`utils`](https://nodes.wavesnodes.com/api-docs/index.html#/utils).<br>3. Нажмите на метод [`/utils/hash/secure`](https://nodes.wavesnodes.com/api-docs/index.html#!/utils/hashSecure_1).<br>4. Создайте уникальную строку API key и включите ее в параметр `message`.<br> 5. Скопируйте хэш API key и вставьте его в файл конфигурации ноды.<br>6. Перезапустите ноду.<br>**Внимание!** API key передается в HTTP-заголовке в открытом виде. Злоумышленники могут перехватить его в процессе передачи по сети и использовать для перевода ваших средств на любой адрес. Очень важно защитить передачу данных с помощью HTTPS- или SSH-ретрансляции порта. | "" |
| 5 | cors | Данный параметр позволяет включить/выключить отправку кросс-доменных запросов CORS к ноде от JavaScript. | yes |

**Примечание**. В запросах к REST API ноды нужно указывать сам [API key](https://en.wikipedia.org/wiki/Application_programming_interface_key), а не его хэш.

Пример подписи транзакции, которая уже существует в кошельке владельца ноды в виде команды curl:

```bash
curl -X POST --header 'Content-Type: application/json' --header 'Accept: application/json' --header 'X-API-Key: YOUR UNIQUE API KEY'
-d '{ \
"amount": 5800000000, \
"fee": 100000, \
"type": 4, \
"version": 1, \
"attachment": "", \
"sender": "3P3pUKEAKxegWr3PZkGYNq1mzQQaQ5zxZbw", \
"feeAssetId": null, \
"assetId": null, \
"recipient": "3P9p39MwZ5JjwdBSYEWC6XYri4jpovzcAbs", \
"feeAsset": null, \
"timestamp": 1568020044350 \
}' 'http://nodes.wavesnodes.com/transactions/sign'
```

#### Генерация хэша API ключа

[API ключ](https://en.wikipedia.org/wiki/Application_programming_interface_key) владельца ноды это важнейший элемент, также как сид фраза и пароль кошелька.

Выполните следующие шаги, чтобы сгенерировать хэш API ключа:<br> 1. Перейдите в [вэб интерфейс Swagger](/ru/waves-node/node-api)<br> 2. Нажмите [utils](https://nodes.wavesnodes.com/api-docs/index.html#/utils)<br>3. Нажмите на API метод [/utils/hash/secure](https://nodes.wavesnodes.com/api-docs/index.html#!/utils/hashSecure_1)<br>4. Создайте уникальный [API ключ](https://en.wikipedia.org/wiki/Application_programming_interface_key) как строку и включите её в параметр `message` <br> 5. Получите API ключ и вставьте его в файл конфигурации ноды <br>6. Перезапустите ноду

**Примечание:** Ключ API передается в заголовке HTTP в виде незащищенного текста. Злоумышленник может перехватить его при передаче по сети и использовать для перевода денег на любой адрес! Очень важно защитить передачу с помощью переадресации портов HTTPS или SSH.

### Настройки синхронизации

В секции `synchronization` можно настроить различные параметры процесса синхронизации.

| Имя | Описание | Значение по умолчанию |
|--------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| `max-rollback` | Задает количество блоков, которые будут сброшены в случае обнаружения форка. Если нода обнаружит форк с более низким `score`, она попытается переключиться на другой форк, для этого нода откатится на несколько блоков. Если обнаруженный форк длиннее заданного значения параметра, нода не будет переключаться, даже если `score` другого форка выше | |
| `max-chain-length` | Задает размер буфера для хранения блоков обнаруженного форка. Размер должен быть больше, чем максимальная длина форка | |
| `synchronization-timeout` | Задает таймаут операции загрузки блока | |
| `score-broadcast-interval` | Задает интервал между публикациями `score` в P2P-cети | |
| `score-ttl` | Задает интервал `time-to-live` публикуемых пакетов `score` | |
| `remote-score-debounce` | Задает время ожидания получения следующего обновления данных `score` от других узлов | |
| `history-replier` | В подсекции можно задать количество последних блоков и микроблоков, которые будут кешироваться в памяти | |
| `micro-block-synchronizer` | В подсекции можно задать различные параметры протокола Waves-NG | |

### Настройки UTX пула

В секции `utx` можно настроить параметры пула неподтвержденных транзакций.

| Имя | Описание | Значение по умолчанию |
|---------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------|
| `max-size` | Задает размер пула неподтвержденных транзакций (как скриптованных, так и нескриптованных) | |
| `max-scripted-size` | Задает размер пула неподтверждённых скриптованных транзакций. До версии ноды 1.1.6 количество транзакций вызова скрипта не учитывалось (учитывались транзакции, для валидации которых требуется выполнить смарт-контракт) | |
| `max-transaction-age` | Задает максимальную давность транзакций. Транзакции, возраст которых превышает значение, установленное в этом параметре, не будут допускаться в UTX пул | |

### Настройки фич

The `features` section allows to set [features](/en/waves-node/features/readme) parameters

| Имя | Описание | Значение по умолчанию |
|--------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
| `auto-shutdown-on-unsupported-feature` | Если этот параметр включен, нода будет выключена при активации функции, которая не реализована в базе кода ноды | yes |
| `supported` | Этот параметр содержит список идентификаторов функций, поддерживаемых владельцем ноды | По умолчанию список пуст |

**Пример**:

```bash
 features {
   auto-shutdown-on-unsupported-feature = yes
   supported = []
 }
```

<a id="rewards"></a>

### Настройки вознаграждения

В данной секции вы можете указать желаемый размер вознаграждения за майнинг в параметре `desired`. Значение указывается в [WAVELET](/ru/blockchain/token/wavelet).

Если значение больше текущего размера вознаграждения, то майнер голосует за увеличение вознаграждения; если меньше — за уменьшение.

**Пример**: желаемый размер вознаграждения 7 WAVES:

```js
waves {
  rewards {
    desired = 700000000
  }
}  
```

В качестве значения может быть указано любое целое число в диапазоне от 0 до 9 223 372 036 854 775 807 включительно.
Отрицательные значения игнорируются.

Подробнее см. в статье [Вознаграждение за майнинг](/ru/blockchain/mining/mining-reward).
